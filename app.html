<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ø£Ø¯Ø§Ø© ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>

<!-- Ù…Ù†Ø¹ Ø£Ø±Ø´ÙØ© Ø§Ù„ØµÙØ­Ø© (Ù…Ù‡Ù… Ø­ØªÙ‰ Ù„Ø§ ØªÙ†Ø§ÙØ³ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ SEO) -->
<meta name="robots" content="noindex, nofollow">

<!-- Ù…ÙƒØªØ¨Ø© Ù‚Ø±Ø§Ø¡Ø© Excel -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body{
    margin:0;
    font-family:Tahoma, Arial;
    background:#020617;
    color:#e5e7eb;
}

.container{
    max-width:1100px;
    margin:auto;
    padding:40px 20px;
}

h1{
    text-align:center;
    margin-bottom:30px;
}

.upload-box{
    background:#0f172a;
    padding:30px;
    border-radius:16px;
    text-align:center;
    border:1px solid #1e293b;
}

input, select{
    padding:10px;
    border-radius:8px;
    border:1px solid #334155;
    background:#1e293b;
    color:white;
    margin:5px;
}

button{
    padding:10px 18px;
    border-radius:10px;
    border:none;
    background:linear-gradient(90deg,#2563eb,#1d4ed8);
    color:white;
    cursor:pointer;
    margin:5px;
    font-weight:bold;
    transition:.2s;
}

button:hover{
    transform:scale(1.05);
}

.table-container{
    margin-top:30px;
    overflow:auto;
}

table{
    border-collapse:collapse;
    width:100%;
}

th,td{
    border:1px solid #334155;
    padding:8px;
    text-align:center;
}

th{
    background:#1e293b;
}

.features{
    margin-top:30px;
    background:#0f172a;
    padding:20px;
    border-radius:12px;
    display:none;
}

.success{
    color:#22c55e;
    margin-top:10px;
}
</style>
</head>

<body>

<div class="container">

<h1>ğŸ“Š Ø£Ø¯Ø§Ø© ØªÙ†Ø¸ÙŠÙ ÙˆØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h1>

<div class="upload-box">
    <p>Ø§Ø±ÙØ¹ Ù…Ù„Ù CSV Ø£Ùˆ Excel Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†Ø¸ÙŠÙ</p>
    <input type="file" id="fileInput" accept=".csv,.xlsx">
</div>

<div class="features" id="toolsSection">
    <h3>Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ</h3>

    <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø¯ÙˆÙ„">

    <br>

    <select id="columnSelect"></select>
    <input type="text" id="oldValue" placeholder="Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©">
    <input type="text" id="newValue" placeholder="Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">

    <br>

    <button onclick="replaceValue()">ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„</button>
    <button onclick="downloadFile()">â¬‡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ</button>

    <div class="success" id="successMsg"></div>
</div>

<div class="table-container" id="tableContainer"></div>

</div>

<script>
let data = [];
let headers = [];
let fileType = "";

document.getElementById('fileInput').addEventListener('change', function(e){
    const file = e.target.files[0];
    fileType = file.name.split('.').pop().toLowerCase();

    const reader = new FileReader();

    if(fileType === "csv"){
        reader.onload = function(event){
            parseCSV(event.target.result);
        };
        reader.readAsText(file);
    } else if(fileType === "xlsx"){
        reader.onload = function(event){
            const workbook = XLSX.read(event.target.result, {type:'binary'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(sheet, {header:1});
            loadData(json);
        };
        reader.readAsBinaryString(file);
    }
});

function parseCSV(text){
    const rows = text.split("\n").map(r => r.split(","));
    loadData(rows);
}

function loadData(rows){
    headers = rows[0];
    data = rows.slice(1).filter(r => r.length > 1);

    updateColumnSelect();
    renderTable(data);

    document.getElementById("toolsSection").style.display = "block";
}

function renderTable(rows){
    let html = "<table><tr>";
    headers.forEach(h => html += "<th>"+h+"</th>");
    html += "</tr>";

    rows.forEach(row=>{
        html += "<tr>";
        headers.forEach((_,i)=>{
            html += "<td>"+(row[i] || "")+"</td>";
        });
        html += "</tr>";
    });

    html += "</table>";
    document.getElementById("tableContainer").innerHTML = html;
}

document.getElementById("searchInput").addEventListener("input", function(){
    const value = this.value.toLowerCase();
    const filtered = data.filter(row =>
        row.some(cell => (cell || "").toString().toLowerCase().includes(value))
    );
    renderTable(filtered);
});

function updateColumnSelect(){
    const select = document.getElementById("columnSelect");
    select.innerHTML="";
    headers.forEach((h,i)=>{
        const option = document.createElement("option");
        option.value=i;
        option.text=h;
        select.appendChild(option);
    });
}

function replaceValue(){
    const col = document.getElementById("columnSelect").value;
    const oldVal = document.getElementById("oldValue").value;
    const newVal = document.getElementById("newValue").value;

    data = data.map(row=>{
        if(row[col] === oldVal){
            row[col] = newVal;
        }
        return row;
    });

    renderTable(data);
    document.getElementById("successMsg").innerText = "ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­ âœ”";
}

function downloadFile(){
    let ws = XLSX.utils.aoa_to_sheet([headers, ...data]);
    let wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Cleaned Data");
    XLSX.writeFile(wb, "cleaned_data.xlsx");
}
</script>

</body>
</html>